<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Matrix Application Service library"><meta name="keywords" content="rust, rustlang, rust-lang, matrix_sdk_appservice"><title>matrix_sdk_appservice - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" href="../normalize.css"><link rel="stylesheet" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" href="../ayu.css" disabled><link rel="stylesheet" href="../dark.css" disabled><link rel="stylesheet" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script defer src="../crates.js"></script><script defer src="../main.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../matrix_sdk_appservice/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div></a><h2></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../matrix_sdk_appservice/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div></a><h2 class="location"><a href="#">Crate matrix_sdk_appservice</a></h2><div class="sidebar-elems"><ul class="block"><li class="version">Version 0.1.0</li><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#reexports">Re-exports</a></li><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#types">Type Definitions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../wheel.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn">Crate <a class="mod" href="#">matrix_sdk_appservice</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/matrix_sdk_appservice/lib.rs.html#15-1052">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Matrix <a href="https://matrix.org/docs/spec/application_service/r0.1.2">Application Service</a> library</p>
<p>The appservice crate aims to provide a batteries-included experience by
being a thin wrapper around the [<code>matrix_sdk</code>]. That means that we</p>
<ul>
<li><input disabled="" type="checkbox" checked=""/>
ship with functionality to configure your webserver crate or simply
run the webserver for you</li>
<li><input disabled="" type="checkbox" checked=""/>
receive and validate requests from the homeserver correctly</li>
<li><input disabled="" type="checkbox" checked=""/>
allow calling the homeserver with proper virtual user identity
assertion</li>
<li><input disabled="" type="checkbox" checked=""/>
have consistent room state by leveraging matrix-sdk’s state store</li>
<li><input disabled="" type="checkbox"/>
provide E2EE support by leveraging matrix-sdk’s crypto store</li>
</ul>
<h2 id="status"><a href="#status">Status</a></h2>
<p>The crate is in an experimental state. Follow
<a href="https://github.com/matrix-org/matrix-rust-sdk/issues/228">matrix-org/matrix-rust-sdk#228</a> for progress.</p>
<h2 id="registration"><a href="#registration">Registration</a></h2>
<p>The crate relies on the appservice registration being always in sync with
the actual registration used by the homeserver. That’s because it’s required
for the access tokens and because membership states for virtual users are
determined based on the registered namespaces.</p>
<h2 id="quickstart"><a href="#quickstart">Quickstart</a></h2>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>matrix_sdk_appservice::{
    ruma::events::room::member::SyncRoomMemberEvent, AppService,
    AppServiceRegistration,
};

<span class="kw">let </span>homeserver_url = <span class="string">&quot;http://127.0.0.1:8008&quot;</span>;
<span class="kw">let </span>server_name = <span class="string">&quot;localhost&quot;</span>;
<span class="kw">let </span>registration = AppServiceRegistration::try_from_yaml_file(
    <span class="string">&quot;./tests/registration.yaml&quot;</span>,
)<span class="question-mark">?</span>;

<span class="kw">let </span><span class="kw-2">mut </span>appservice = AppService::builder(
    homeserver_url.try_into()<span class="question-mark">?</span>,
    server_name.try_into()<span class="question-mark">?</span>,
    registration,
)
.build()
.<span class="kw">await</span><span class="question-mark">?</span>;
appservice.virtual_user(<span class="prelude-val">None</span>).<span class="kw">await</span><span class="question-mark">?</span>.add_event_handler(
    |_ev: SyncRoomMemberEvent| <span class="kw">async </span>{
        <span class="comment">// do stuff
    </span>},
);

<span class="kw">let </span>(host, port) = appservice.registration().get_host_and_port()<span class="question-mark">?</span>;
appservice.run(host, port).<span class="kw">await</span><span class="question-mark">?</span>;</code></pre></div>
<p>Check the <a href="https://github.com/matrix-org/matrix-rust-sdk/tree/main/crates/matrix-sdk-appservice/examples">examples directory</a> for fully working examples.</p>
</div></details><h2 id="reexports" class="small-section-header"><a href="#reexports">Re-exports</a></h2><div class="item-table"><div class="item-row"><div class="item-left import-item" id="reexport.matrix_sdk"><code>pub use matrix_sdk;</code></div></div><div class="item-row"><div class="item-left import-item" id="reexport.ruma"><code>pub use matrix_sdk::<a class="mod" href="https://docs.rs/ruma/0.7.4/ruma/index.html" title="mod ruma">ruma</a>;</code></div></div><div class="item-row"><div class="item-left import-item" id="reexport.AppServiceRegistration"><code>pub use registration::<a class="struct" href="registration/struct.AppServiceRegistration.html" title="struct matrix_sdk_appservice::registration::AppServiceRegistration">AppServiceRegistration</a>;</code></div></div><div class="item-row"><div class="item-left import-item" id="reexport.VirtualUserBuilder"><code>pub use virtual_user::<a class="struct" href="virtual_user/struct.VirtualUserBuilder.html" title="struct matrix_sdk_appservice::virtual_user::VirtualUserBuilder">VirtualUserBuilder</a>;</code></div></div></div><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="mod" href="event_handler/index.html" title="matrix_sdk_appservice::event_handler mod">event_handler</a></div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="registration/index.html" title="matrix_sdk_appservice::registration mod">registration</a></div><div class="item-right docblock-short">AppService Registration.</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="virtual_user/index.html" title="matrix_sdk_appservice::virtual_user mod">virtual_user</a></div><div class="item-right docblock-short">Virtual users.</div></div></div><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.AppService.html" title="matrix_sdk_appservice::AppService struct">AppService</a></div><div class="item-right docblock-short">AppService</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.AppServiceBuilder.html" title="matrix_sdk_appservice::AppServiceBuilder struct">AppServiceBuilder</a></div><div class="item-right docblock-short">Builder for an AppService</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.AppServiceRouter.html" title="matrix_sdk_appservice::AppServiceRouter struct">AppServiceRouter</a></div></div></div><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.Error.html" title="matrix_sdk_appservice::Error enum">Error</a></div></div></div><h2 id="types" class="small-section-header"><a href="#types">Type Definitions</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="type" href="type.Result.html" title="matrix_sdk_appservice::Result type">Result</a></div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="matrix_sdk_appservice" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.67.0-nightly (09508489e 2022-11-04)" ></div></body></html>